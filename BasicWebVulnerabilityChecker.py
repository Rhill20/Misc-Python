import tkinter as tk
import requests
from bs4 import BeautifulSoup

def scan_website():
    target_url = target_entry.get()

    # Send  GET 
    response = requests.get(target_url)
    html_content = response.text

    vulnerabilities = []
    
    #  Cross-Site Scripting (XSS)
    if BeautifulSoup(html_content, 'html.parser').find('script'):
        vulnerabilities.append("Cross-Site Scripting (XSS)")

    #  SQL Injection
    if "error" in html_content.lower():
        vulnerabilities.append("SQL Injection")

    #  Path Traversal
    if "../" in target_url:
        vulnerabilities.append("Path Traversal")

    # Server-Side Request Forgery (SSRF)
    if "localhost" in target_url:
        vulnerabilities.append("Server-Side Request Forgery (SSRF)")

    # Insecure Direct Object References (IDOR)
    if "admin" in target_url:
        vulnerabilities.append("Insecure Direct Object References (IDOR)")

    if vulnerabilities:
        result_label.config(text="Vulnerabilities Detected:\n" + "\n".join(vulnerabilities))
    else:
        result_label.config(text="No Vulnerabilities Found.")
        
def clear_text():
    target_entry.delete(0, tk.END)
    result_label.config(text="")

# UI
root = tk.Tk()
root.title("Web Vulnerability Scanner")
root.geometry("400x200")

target_label = tk.Label(root, text="Target URL:")
target_label.pack()

target_entry = tk.Entry(root, width=50)
target_entry.pack()

scan_button = tk.Button(root, text="Scan", command=scan_website)
scan_button.pack()

result_label = tk.Label(root, text="")
result_label.pack()

clear_button = tk.Button(root, text="Clear", command=clear_text)
clear_button.pack()

root.mainloop()
